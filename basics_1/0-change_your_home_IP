#!/usr/bin/env bash
# Configures localhost to resolve to 127.0.0.2 and facebook.com to 8.8.8.8

# Backup the original /etc/hosts file
sudo cp /etc/hosts /etc/hosts.bak

# Create a temporary hosts file
TEMP_HOSTS="/tmp/hosts.new"

# Copy current /etc/hosts to temp file
cp /etc/hosts "$TEMP_HOSTS"

# Update localhost to 127.0.0.2
if grep -q "localhost" "$TEMP_HOSTS"; then
    sed 's/.*localhost/127.0.0.2 localhost/' "$TEMP_HOSTS" > "$TEMP_HOSTS.tmp"
    mv "$TEMP_HOSTS.tmp" "$TEMP_HOSTS"
else
    echo "127.0.0.2 localhost" >> "$TEMP_HOSTS"
fi

# Update facebook.com to 8.8.8.8
if grep -q "facebook.com" "$TEMP_HOSTS"; then
    sed 's/.*facebook.com/8.8.8.8 facebook.com/' "$TEMP_HOSTS" > "$TEMP_HOSTS.tmp"
    mv "$TEMP_HOSTS.tmp" "$TEMP_HOSTS"
else
    echo "8.8.8.8 facebook.com" >> "$TEMP_HOSTS"
fi

# Replace /etc/hosts with the updated file
sudo mv "$TEMP_HOSTS" /etc/hosts